FROM ubuntu:latest

RUN mkdir -p /app
RUN mkdir -p /app/data
RUN mkdir -p /app/config
RUN mkdir -p /app/log

WORKDIR /app
COPY supervisor /app/
COPY supervisor.settings.json /app/config/
COPY dist/* /app/dist

ENV HTTP_ALLOWED_ORIGIN=*
ENV HTTP_ENABLE_GRAPHIQL=true
ENV AUTHENTICATION_HASH_COST=16
ENV AUTHENTICATION_TOKEN_SIZE=128
ENV AUTHENTICATION_SESSION_DURATION=12
ENV LOGGER_MODE=info
ENV LOGGER_SYNC_ACTIVE=true
ENV LOGGER_LOG_RETENTION=168
ENV LOGGER_CHECK_INTERVAL=6
ENV LOGGER_RUN_CLEANUP=true

EXPOSE 3030

# Run the image
ENTRYPOINT ["/app/supervisor"]